<!DOCTYPE html>
<html>
<head lang="zh">
<meta charset="UTF-8">
<title>只此一回，阅后即焚，添加内容。</title>
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="email=no" name="format-detection">

<style>
    *{
        margin:0px;
        padding: 0px;
    }
    #msg{
        display: none;
    }
</style>
<script>
    function post(){
        var text=document.getElementById("text").value;
        
        var t=new Date().getTime(),w=window,d=w.document,b=d.body,s=d.createElement("script");
        s.charset="utf-8";
        s.type="text/javascript";
        s.src="http://dobebox.jd-app.com/postapi.php?text="+text;b.appendChild(s);
    }

    function init(){
            document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
            var icon="res/icon.png";
            var url=document.location.href;
            var urlArr=url.split("/");
            var imgUrl="";
            for(i=0; i<urlArr.length-1;i++){
                imgUrl+=urlArr[i]+"/";
            }
            imgUrl+=icon;
            shareLink="http://www.dobebox.com/readonce";
            shareTitle="只此一回，阅后即焚";
            shareIcon="http://www.dobebox.com/readonce/icon.png";
            // 发送给好友
            WeixinJSBridge.on('menu:share:appmessage', function (argv) {
                WeixinJSBridge.invoke('sendAppMessage', {
                    "img_url":shareIcon,
                    "img_width": "100",
                    "img_height": "100",
                    "link": shareLink,
                    "desc": "",
                    "title": shareTitle
                }, function (res) {
                    _report('send_msg', res.err_msg);
                })
            });
            // 分享到朋友圈
            WeixinJSBridge.on('menu:share:timeline', function (argv) {
                WeixinJSBridge.invoke('shareTimeline', {
                    "img_url":shareIcon,
                    "img_width": "100",
                    "img_height": "100",
                    "link": shareLink,
                    "desc": "",
                    "title": shareTitle
                }, function (res) {
                    _report('timeline', res.err_msg);
                });
            });
            
        });    
            document.getElementById("submit").addEventListener("click",post,false);
    }
    window.addEventListener("load",init,false);
</script>
</head>
<body>
    <div id="msg">右上角分享给微信好友吧！你的好友看了以后这条消息就会被永久删除。</div>
    <textarea id="text" name="text"></textarea>
    <input id="submit" type="submit" value="提交">
</body>
</html>