<!DOCTYPE html>
<html>
<head lang="zh">
<meta charset="UTF-8">
<title>车车往前冲</title>
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="email=no" name="format-detection">
<style>
    *{
        margin:0px;
        padding: 0px;
    }
    #myCanvas{
        width:100%;
        height:100%;
        position: fixed;
        top: 0px;
        left: 0px;
        right: 0px;
        bottom: 0px;
        z-index: 0;
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnYAAAOECAMAAAAbp4xtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAxQTFRFFL87KKxG////KBwcsQr8XwAACjxJREFUeNrs3LENAkEAA8Hn6b9n0o1OCOQEZkuwJvZ1HXsq3cfs065vMh922GGHHXbYYYcddthhhx122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywww477LDDDjvssMMOO+ywww477LATdthhhx122GGHHXbYYYcddtj9HLvHMfNh91lnV9hhhx122GGHHXbYYYcddthhhx12wg477LDDDjvssMMOO+ywww477LDDDjvssMNO2GGHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDrt/Y+doDLtF/u2www477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywww477LDDDjvssMMOO+ywww477LATdthhhx12zdEYdov822GHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GGHHXbYYYcddthhhx122GGHHXbYYSfssMMOO+zKztEYdov822GHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GGHHXbYYYcddthhhx122GGHHXbYYSfssMMOO+yaozHsFvm3ww477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+ywww477LDDDjvssMMOO+ywww477LDDTthhhx122JWdozHsFvm3ww477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+ywww477LDDDjvssMMOO+ywww477LDDTthhhx122DVHY9gt8m+HHXbYYYcddthhhx122GGHHXbYYYcddthhJ+ywww477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywKztHY9gt8m+HHXbYYYcddthhhx122GGHHXbYYYcddthhJ+ywww477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywa47GsFvk3w477LDDDjvssMMOO+ywww477LDDDjvssMNO2GGHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GFXdo7GsFvk3w477LDDDjvssMMOO+ywww477LDDDjvssMNO2GGHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GHXHI1ht8i/HXbYYYcddthhhx122GGHHXbYYYcddthhh52www477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+yww67sHI1pkX87YSfssBN2wg47YSfsJOyEnYSdsBN22Ak7YYedsBN2EnbCTsJO2Ak77ISdsMNO2Ak7CTthJ2En7IRdczSmRf7thJ2ww07YCTvshJ2wk7ATdhJ2wk7YYSfshB12wk7YSdgJOwk7YSfssBN2wg47YSfsJOyEnYSdsBN2ZedoTIv82wk7YYedsBN22Ak7YSdhJ+wk7ISdsMNO2Ak77ISdsJOwE3YSdsJO2GEn7IQddsJO2EnYCTsJO2En7JqjMS3ybyfshB12wk7YYSfshJ2EnbCTsBN2wg47YSfssBN2wk7CTthJ2Ak7YYedsBN22Ak7YSdhJ+wk7ISdsCs7R2Na5N9O2Ak77ISdsMNO2Ak7CTthJ2En7IQddsJO2GEn7ISdhJ2wk7ATdsIOO2En7LATdsJOwk7YSdgJO2HXHI1pkX87YSfssBN2wg47YSfsJOyEnYSdsBN22Ak7YYedsBN2EnbCTsJO2Ak77ISdsMNO2Ak7CTthJ2En7IRd2Tka0yL/dsJO2GEn7IQddsJO2EnYCTsJO2En7LATdsIOO2En7CTshJ2EnbATdtgJO2GHnbATdhJ2wk7CTtgJu+Zo7P3uY/Zp/u2www477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywww477LDDDjvssMMOO+ywww477LATdthhhx12ZedoDLtF/u2www477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywww477LDDDjvssMMOO+ywww477LATdthhhx12zdEYdov822GHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GGHHXbYYYcddthhhx122GGHHXbYYSfssMMOO+zKztEYdov822GHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GGHHXbYYYcddthhhx122GGHHXbYYSfssMMOO+yaozHsFvm3ww477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+ywww477LDDDjvssMMOO+ywww477LDDTthhhx122JWdozHsFvm3ww477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+ywww477LDDDjvssMMOO+ywww477LDDTthhhx122DVHY9gt8m+HHXbYYYcddthhhx122GGHHXbYYYcddthhJ+ywww477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywKztHY9gt8m+HHXbYYYcddthhhx122GGHHXbYYYcddthhJ+ywww477LDDDjvssMMOO+ywww477LDDDjvshB122GGHHXbYYYcddthhhx122GGHHXbYYYedsMMOO+ywa47GsFvk3w477LDDDjvssMMOO+ywww477LDDDjvssMNO2GGHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GFXdo7GsFvk3w477LDDDjvssMMOO+ywww477LDDDjvssMNO2GGHHXbYYYcddthhhx122GGHHXbYYYcddtgJO+ywww477LDDDjvssMMOO+ywww477LDDDjthhx122GHXHI1ht8i/HXbYYYcddthhhx122GGHHXbYYYcddthhh52www477LDDDjvssMMOO+ywww477LDDDjvssBN22GGHHXbYYYcddthhhx122GGHHXbYYYcddsIOO+ywwy69BBgAk2mVrrQs0EcAAAAASUVORK5CYII=);
        background-size: 100% 100%;
    }
    #welcome,#gameover,#loading{
        width:100%;
        height:100%;
        position: fixed;
        top: 0px;
        bottom: 0px;
        left: 0px;
        right: 0px;
        display: none;
        z-index: 999;
    }
    
    #welcome{
        background: rgba(255,255,255,.3);
    }
    #gameover{
        background: rgba(255,255,255,.3);
    }
    p{
        width: 90%;
        left: 5%;
        position: fixed;
        top: 45%;
        color: #fff;
    }
    #start{
        width: 36%;
        height: 60px;
        line-height:60px;
        text-align: center;
        left: 33%;
        position: fixed;
        
        border: none;
        outline: none;
        bottom: 8%;
        zoom: 0;
        background: rgba(255,0,0,.9);
        color:#fff;

    }
    #msg{
        position: fixed;
        top: 31%;
        width: 100%;
        left: 0px;
        right: 0px;
        text-align: center;
        font-size: 18px;
        font-weight: 700;
        color: #000;
    }
    #restart{
        width: 40%;
        height: 40px;
        line-height:40px;
        text-align: center;
        left:0px;
        position: fixed;
        background: rgba(255,0,0,1);
        color:#fff;
        color: #fff;
        font-size: 18px;
        border: none;
        outline: none;
        bottom: 8%;
        zoom: 0;
    }
    #link{
        width: 40%;
        height: 40px;
        line-height:40px;
        text-align: center;
        right: 0px;
        position: fixed;
        background: rgba(255,0,0,1);
        color:#fff;
        font-size: 18px;
        border: none;
        outline: none;
        bottom: 8%;
        zoom: 0;
    }
    #copy{
        position: fixed;
        bottom: 0px;
        width: 100%;
        height: 30px;
        line-height: 30px;
        text-align: center;
        color: #f00;
        z-index: 999;
        background: rgba(255,255,255,0.5);
    }
</style>
<script>
    function welcome(){
        document.getElementById("welcome").style.display="block";
        document.getElementById("gameover").style.display="none";
        document.getElementById("loading").style.display="none";
        //document.getElementById("myCanvas").style.display="none";
    }
    function gameover(){
        loop=false;
        var msg="我在高速路上行驶了"+player_time+"秒钟，你也来试试啊！";
        
        shareTitle=msg;
        
        document.getElementById("msg").innerHTML=msg;
        document.getElementById("gameover").style.display="block";
        document.getElementById("welcome").style.display="none";
        document.getElementById("loading").style.display="none";
    }
    function link(){
        window.location.href="http://www.dobebox.com";
    }
    function init(){
        player_w=204;
        player_h=312;
        //canvas
        canvas_w=630;
        canvas_h=960;
        canvas=document.getElementById("myCanvas");
        canvas.width=canvas_w;
        canvas.height=canvas_h;
        canvas.top = 0;
        canvas.left = 0;
        c = canvas.getContext('2d');
        res_count=0;
        resloaded=false;
        fps=1000/16;
        loop=false;
        loadingRES();
        backTime=0;
        setInterval(looping,fps);


        canvas.addEventListener('touchstart', function (e) {
            var touchobj = e.changedTouches[0] // reference first touch point (ie: first finger)
            startx = parseInt(touchobj.clientX) // get x position of touch point relative to left edge of browser
            player_to="left";
            e.preventDefault();
        }, false);

        canvas.addEventListener('touchmove', function (e) {
            var touchobj = e.changedTouches[0] // reference first touch point for this event
            var distX = parseInt(touchobj.clientX) - startx;
            e.preventDefault()
        }, false);

        canvas.addEventListener('touchend', function (e) {
            var touchobj = e.changedTouches[0] // reference first touch point for this event
            //statusdiv.innerHTML = 'Status: touchend<br /> Resting x coordinate: ' + touchobj.clientX + 'px'
            e.preventDefault()
        }, false);
        //
document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        var icon="res/icon.png";
        var url=document.location.href;
        var urlArr=url.split("/");
        var imgUrl="";
        for(i=0; i<urlArr.length-1;i++){
            imgUrl+=urlArr[i]+"/";
        }
        imgUrl+=icon;
        shareLink=document.location.href;
        shareTitle=document.title;
        shareIcon="http://mmbiz.qpic.cn/mmbiz/ZBB7rRgWr0sQORlvCzyEqq72ibnm2ep0NbZs6hPLrh7arpjTia8aCwuRlz8brhuQUl7YEIxZeUTJlib2yicP6lXNbA/640";
        // 发送给好友
        WeixinJSBridge.on('menu:share:appmessage', function (argv) {
            WeixinJSBridge.invoke('sendAppMessage', {
                "img_url":shareIcon,
                "img_width": "100",
                "img_height": "100",
                "link": shareLink,
                "desc": "",
                "title": shareTitle
            }, function (res) {
                _report('send_msg', res.err_msg);
            })
        });
        // 分享到朋友圈
        WeixinJSBridge.on('menu:share:timeline', function (argv) {
            WeixinJSBridge.invoke('shareTimeline', {
                "img_url":shareIcon,
                "img_width": "100",
                "img_height": "100",
                "link": shareLink,
                "desc": "",
                "title": shareTitle
            }, function (res) {
                _report('timeline', res.err_msg);
            });
        });
    });
    }
    function loadedOne(){
        res_count++;
    }
    function loadingRES(){
        document.getElementById("loading").style.display="block";
        document.getElementById("welcome").style.display="none";
        //document.getElementById("myCanvas").style.display="none";
        document.getElementById("gameover").style.display="none";

        car_img=new Image();
        player_img=new Image();

        


        car_img.onload=loadedOne;
        
        player_img.onload=function(){
            res_count++;
            c.clearRect(0, 0,canvas_w,canvas_h);
            c.drawImage(this,0,0,player_w,player_h);
            player_data = c.getImageData(0,0,player_w,player_h).data;
            c.clearRect(0, 0,canvas_w,canvas_h);
        }

        player_img.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAAE4CAMAAAAgiOx7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF1GtrcyEhrycn23FxbBwc/wAAzDMz////NSfHDgAAAAh0Uk5T/////////wDeg71ZAAACbUlEQVR42uzdy27DIBAFUAiu8/9/3FWbcRUk3EQyQ85ddZOKU6g8wTzK/ZH2lTAtAAoMDAwMDAzMJ2JaSEpMSNlvP9lvdftN3SdIaE8v9RYA5Ray5cNssf0wMDAwMDAwMDAwMDAwMDAwl2dbq2fqT/JjRoYcDAwMDAwMDAwMDAwMDAwMzJKYbTbM6amm+pimmrBnns+hdTF7klQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGJj9+H4zf8+EdDHhdJASXohOlq2WkEHMtKnxSJaVMAUGBgYGJg+mLfXQDDkUEDMIQobKmd4H6gy90flDD63RnOz/p9seGBgYGBgYmLdiOuXDVemVV0O7NHq/6Kr0Ct8hTK/kvijlpf0zMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDCnMN33iTNgOhlaPBfTJkivbSPLGtNkZMFplhQYGBgYmDyYtR6aK5UzSxWavs/AwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwKx87MRSB4I4dwYGBgYGBuZjMEsd17rUQbptrqE1MuTcCwADAwMDcw1mrYfmoR5Lfs1R/Ej6C6hiX6a/GiyOy/SXtsHAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAvAMTFnjNAQsvjF/acjLF+83tXftnZhtaMDAwMDAwMCtjevVYSszIGsdEPQMDAwMD8wGYyyY0Xnpo/llyf/lU0/P9CNv5O5tmngQ8fWfTzJh2cp9mFkyBgYGBgcmDSf/Q3B8/7xnLmUP7o7JXz7UJ0is0D8fT3R9pne8Ptd0vz1DbYGBgYGBgYP6F6WQKzEDbvgUYAOHBL0u5xFRyAAAAAElFTkSuQmCC";
        car_img.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAAE4CAMAAAAgiOx7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF1NJrtLI1//oAr6wn29lxbGoczMkz////mbfregAAAAh0Uk5T/////////wDeg71ZAAAB30lEQVR42uzdQW6EMAwF0KQNcP8bd4nbKlIolYjD+3tGfmIWZiY25TjTPhKmBUCBgYGBgYGBeSOmhaTEhJQasoXsE2QbSKy/1M8zGTGhfBgYGBgYGBgYGBgYGBgYGBgYmIHUlTA7DAwMDAwMDAwMDAwMDAwMDEwqzJ4jdSXMDgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDM4wJ20HKNnFKSBfTsmBCoTAwMDAwMDB3MbFNSN/O9C6YDXD5JOBsTWevHhgYGBgYGJh/xazUzvQ+6KncmtLotdwPBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYG5m+Y3v+JbYL0ahs51pgmMDAwMDAwMHcxS7UzumYYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYmPdgsq+dsN/M3hkYGBgYGJjsmOztzFKLdNtkX62RRxIYGBgYGJgnMHWpO7PsewHSv4AKBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgbmJ6bOa6mXMbPdpV5tMDAwMDAwMDA5MDU9ZuQgHQwMDAwMDAzMqpg4MDDzL5ojgw1x5KTNjGkXh4FgYGBgYGBgfmFCMrYz3+qPyl4z1ybISG3lONO/4Hg8Q7XBwMDAwMDAvBHzJcAATKWvLhrDniYAAAAASUVORK5CYII=";
    }
    function checking(){

    }
    function restart(){


        tangetX=0;
        tangetT=0;
        player_x=30;
        player_y=canvas_h-player_h-20;
        win=false;
        
        player_setp=30;
        player_time=0;
        fps=1000/32;
        loopTime=0;
        player_to="right";
        makeCarTime=0;
        backgroundY=0;
        //
        //document.getElementById("myCanvas").style.display="block";
        document.getElementById("welcome").style.display="none";
        document.getElementById("loading").style.display="none";
        document.getElementById("gameover").style.display="none";
        //
        time=0;
        cars=new Array();
        carNext=0;
        loop=true;
    }

    function looping(){

        if(loop){
            //
            backgroundY+=10;
            
            document.getElementById("myCanvas").style.backgroundPositionY=backgroundY+"px";
            
            loopTime+=fps;
                c.clearRect(0, 0,canvas_w,canvas_h);
                for(i in cars){
                    
                    c.drawImage(car_img,cars[i][0],cars[i][1], player_w, player_h);

                }
                player();
                var data = c.getImageData(player_x,player_y,player_w,player_h).data;
                var step=0;
                for (var ii = 3; ii < data.length; ii += 4) {
                    if(loop){
                        step++;
                        if(step==1){
                            if (data[ii]>0 && player_data[ii] > 0) {
                                    ii=data.length;
                                    gameover();
                                if(data[ii-3]==255 && data[ii-2]==153 && data[ii-1]==0){
                                    
                                }
                                else if(data[ii-3]==255 && data[ii-2]==0 && data[ii-1]==0){
                                    ii=data.length;
                                    gameover();
                                }
                                else if(data[ii-3]==0 && data[ii-2]==153 && data[ii-1]==255){
                                    win=true;
                                    ii=data.length;
                                    gameover();
                                }
                                
                                break;
                            }
                            step=0;
                        }
                    }
                }        


            //
            c.clearRect(0, 0,canvas_w,canvas_h);
            //c.drawImage(bg_img,0,0,canvas_w,canvas_h);
            makeCarTime+=fps;
            
            if(makeCarTime>=1000){
                //cars.push([canvas_w-player_w-60],-1*player_h]);
                if(carNext==0){
                    carNext=1;
                    cars.push([60,-1*player_h]);
                }else{
                    carNext=0;
                    cars.push([canvas_w-player_w-60,-1*player_h]);
                }
                
                
                makeCarTime=0;
            }
            
            for(i in cars){
                cars[i][1]+=60;
                c.drawImage(car_img,cars[i][0],cars[i][1], player_w, player_h);
                if(cars[i][1]>canvas_h+player_h+100){
                    cars.splice(i,1);
                }
            }
            
            
            c.drawImage(player_img, player_x, player_y, player_w, player_h);
            time+=fps;
            
            if(time==1000){
                time=0;
                player_time++;
            }
            c.font="50px Georgia";
            c.fillStyle="#f00";
            c.fillText(player_time,canvas_w/2-15,60);

            //

            //
        }
        //checking res loaded?
        if(resloaded==false){
            if(res_count==2){
                welcome();
                resloaded=true;
            }
        }
    }
    function player(){
        if(player_to=="right"){
            player_x+=player_setp;
            if(player_x>=canvas_w-player_w-60){
                //player_to="left";
                player_x=canvas_w-player_w-60;
            }
        }
        if(player_to=="left"){
            player_x-=player_setp;
            if(player_x<=60){
                //player_to="right";
                player_x=60;
                player_to="right";
            }
        }

    }
    window.addEventListener('load',init,false);

</script>
</head>
<body>
<div id="loading">loading</div>
<div id="welcome">
    <div id="start" ontouchstart="restart();">猛戳此处开始</div>
</div>
<div id="gameover">
    <p id="msg"></p>
    <div id="restart" ontouchstart="restart();">再玩一局！</div>
    <div id="link" ontouchstart="link();">更多游戏</div>
</div>
<canvas id="myCanvas"></canvas>
<div id="copy">逗比盒子</div>
<span id="tongji" style="display: none;"><script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fc961dabb84f92a11e4c69829d2968259' type='text/javascript'%3E%3C/script%3E"));
</script><script src=" http://hm.baidu.com/h.js?c961dabb84f92a11e4c69829d2968259" type="text/javascript"></script><a href="http://tongji.baidu.com/hm-web/welcome/ico?s=c961dabb84f92a11e4c69829d2968259" target="_blank"><img border="0" src="http://eiv.baidu.com/hmt/icon/21.gif" width="20" height="20"></a></span>
</body>
</html>
